webpackJsonp([51],{daaC:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("SoR+"),i=a.n(s),r=a("o6Vb"),o={name:"AddRelInfo",data:function(){return{relativeInfo:{},pickerRel:"父子",currentAge:"",pickerAge:"",sexs:[{tag:"女"},{tag:"男"}],slot:[{flex:1,values:["父子","母子","父女","母女","近亲属"],className:"slot1",textAlign:"center"}],validateTable:{name:{required:!0,reg:/^[\w\·\u4E00-\u9FA5]+$/,message:"姓名格式不正确"}},addressForm:{countryCode:"国家代码",countryName:"国家名称",provinceCode:"省市代码",provinceName:"省市名称",cityCode:"城市代码",cityName:"城市名称",areaCode:"区域代码",areaName:"区域名称",streetCode:"街道代码",streetName:"区域名称",address:"详细的地址"},visiualMusk:!1,visiualRel:!1,visiualAge:!1,pickerVisible:!1,startDate:new Date("1930-01"),endDate:new Date,addressDetail:"",addressHodler:"（例：某小区A座6号楼6单元502室）",addressVisible:!1,regionInit:!1,addressSlots:[{flex:1,values:this.getProvinceArr(),className:"slot1",textAlign:"center"},{divider:!0,content:"",className:"slot2"},{flex:1,values:this.getCityArr("北京市"),className:"slot3",textAlign:"center"},{divider:!0,content:"",className:"slot4"},{flex:1,values:this.getCoutyArr("北京市","北京市"),className:"slot5",textAlign:"center"}],slots:[{flex:1,className:"slot1",textAlign:"center"}],relativeInfoForm:{relativesName:"亲属姓名",sex:0,nexus:"父子",birthday:new Date("1990-01"),addressDto:{province:"",city:"",district:"",street:"",streetNumber:""},age:""},birthdayVisiual:null,addressValue:"",modifyRelInfoSelected:""}},computed:{relId:function(){return this.$route.query.relid},computedSexTag:function(){return this.sexs[this.relativeInfoForm.sex].tag},modifyRelInfoSelected_:function(){var e=this.$sessionStorage.getItem("modifyRelInfoSelectedPlain");this.$sessionStorage.getItem("modifyRelInfoSelected");return e}},watch:{},created:function(){this.$validate.init(this)},mounted:function(){this.init()},beforeRouteLeave:function(e,t,a){this.$sessionStorage.removeItem("modifyRelInfoSelected"),this.$sessionStorage.removeItem("modifyRelInfoSelectedPlain"),a()},methods:{init:function(){var e=this,t=this.$route.query.relid;Object(r.l)({relativesId:t}).then(function(a){if(200==a.data.code){var s=a.data.data;e.relativeInfoForm={relativesName:s.relativesName,relativesId:t,nexus:s.nexus,sex:s.sex,birthday:new Date(s.birthday),age:s.age},e.birthdayVisiual=s.birthday;var i=e.$sessionStorage.getItem("modifyRelInfoSelectedPlain"),r=e.$sessionStorage.getItem("modifyRelInfoSelected");i&&(e.modifyRelInfoSelected=i),r&&(e.addRelInfoSelected=e.addressTransform(r),e.relativeInfoForm.addressDto=r,e.addressDetail=r.address)}})},addressTransform:function(e){return e.provinceName+"-"+e.cityName+"-"+e.areaName+"-"+e.streetName},getBirthday:function(e){if(!e)return"";var t=new Date(e),a=t.getFullYear(),s=t.getMonth()+1;return a+"-"+(s=s<10?"0"+s:s)},routeBack:function(){this.$router.push({path:"/healthrecords"}),this.$sessionStorage.removeItem("modifyRelInfoSelected"),this.$sessionStorage.removeItem("modifyRelInfoSelectedPlain")},submitModify:function(){var e=this;Object(r.t)(this.relativeInfoForm).then(function(t){200===t.data.code&&(e.$message({message:t.data.msg,center:!0,type:"success",showClose:!0,duration:1e3}),e.$store.dispatch("SET_USER_INFO"),setTimeout(function(){e.$router.push({path:"/healthrecords",query:{relid:e.$route.query.relid,selectedIndex:e.$route.query.selectedIndex}})},300))})},changeSex:function(e){this.relativeInfoForm.sex=e},clearname:function(){this.relativeInfoForm.relativesName=""},onValuesChange:function(e,t){this.pickerRel=t[0]},chooseRel:function(){this.visiualMusk=!0,this.visiualRel=!0,this.visiualAge=!1},chooseAge:function(){this.visiualRel=!1,this.visiualAge=!0,this.$refs.dataPicker.open()},disappearMusk:function(){this.visiualMusk=!1},confirmModifyRel:function(e){this.relativeInfoForm.nexus=this.pickerRel,this.visiualMusk=!1},handleConfirm:function(){},dataChange:function(e){},dateConfirm:function(e){e.setDate(15);var t=e.getFullYear(),a=e.getMonth()+1;this.relativeInfoForm.birthday=e,this.birthdayVisiual=t+"-"+a,this.relativeInfoForm.age=(new Date).getFullYear()-e.getFullYear()},showAddressPicker:function(){this.addressVisible=!0},getProvinceArr:function(){var e=[];return i.a.forEach(function(t){var a={};a.name=t.name,a.code=t.code,e.push(a)}),e},getCityArr:function(e){var t=[];return i.a.forEach(function(a){a.name===e&&a.children.forEach(function(e){var a={};a.name=e.name,a.code=e.code,t.push(a)})}),t},getCoutyArr:function(e,t){var a=[];return i.a.forEach(function(s){s.name===e&&s.children.forEach(function(e){e.name===t&&e.children.forEach(function(e){var t={};t.name=e.name,t.code=e.code,a.push(t)})})}),a},addressChoose:function(){this.$router.push({path:"/choosereladdress",query:{relid:this.$route.query.relid}}),this.$sessionStorage.removeItem("modifyRelInfoSelected"),this.$sessionStorage.removeItem("modifyRelInfoSelectedPlain")},addressChange:function(e,t){this.addressForm={countryCode:"CHN",countryName:"中国",provinceCode:t[0].code,provinceName:t[0].name,cityCode:t[1].code,cityName:t[1].name,areaCode:t[2]?t[2].code:"",areaName:t[2]?t[2].name:"",streetCode:"街道代码",streetName:"区域名称"},this.relativeInfoForm.addressDto=this.addressForm,this.modifyRelInfoSelected=this.addressTransform(this.addressForm),e.setSlotValues(1,this.getCityArr(t[0].name)),e.setSlotValues(2,this.getCoutyArr(t[0].name,t[1].name))}}},n={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"modifyRelInfo"}},[s("header",[s("Backfront",{attrs:{maintitle:"修改亲属信息",isNormal:!0},on:{back:e.routeBack}})],1),e._v(" "),s("main",[s("div",{staticClass:"card",on:{click:e.chooseRel}},[s("p",{staticClass:"cardtitle"},[e._v("与您的关系:")]),e._v(" "),s("div",{staticClass:"inputwrapper"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.relativeInfoForm.nexus,expression:"relativeInfoForm.nexus"}],attrs:{type:"text",disabled:!0},domProps:{value:e.relativeInfoForm.nexus},on:{input:function(t){t.target.composing||e.$set(e.relativeInfoForm,"nexus",t.target.value)}}})]),e._v(" "),e._m(0)]),e._v(" "),s("div",{staticClass:"card"},[s("p",{staticClass:"cardtitle"},[e._v("姓名:")]),e._v(" "),s("div",{staticClass:"inputwrapper"},[s("input",{directives:[{name:"validate",rawName:"v-validate:form_$relname",value:e.validateTable.name,expression:"validateTable.name",arg:"form_$relname"},{name:"model",rawName:"v-model",value:e.relativeInfoForm.relativesName,expression:"relativeInfoForm.relativesName"}],attrs:{type:"text"},domProps:{value:e.relativeInfoForm.relativesName},on:{input:function(t){t.target.composing||e.$set(e.relativeInfoForm,"relativesName",t.target.value)}}})]),e._v(" "),s("div",{staticClass:"choose relativename"},[e.relativeInfoForm.relativesName?s("img",{attrs:{src:a("lz3y")},on:{click:e.clearname}}):e._e()])]),e._v(" "),s("div",{staticClass:"card"},[s("p",{staticClass:"cardtitle"},[e._v("性别:")]),e._v(" "),s("div",{staticClass:"inputwrapper"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.computedSexTag,expression:"computedSexTag"}],attrs:{type:"text",disabled:!0},domProps:{value:e.computedSexTag},on:{input:function(t){t.target.composing||(e.computedSexTag=t.target.value)}}})]),e._v(" "),s("div",{directives:[{name:"echo",rawName:"v-echo"}],staticClass:"choose sexs"},e._l(e.sexs,function(t,a){return s("div",{key:a,staticClass:"sex",on:{click:function(t){e.changeSex(a)}}},[s("span",{staticClass:"circle",class:{active:e.relativeInfoForm.sex===a}}),e._v(" "),s("span",[e._v(e._s(t.tag))])])}))]),e._v(" "),s("div",{staticClass:"card",on:{click:e.chooseAge}},[s("p",{staticClass:"cardtitle"},[e._v("生日:")]),e._v(" "),s("div",{staticClass:"inputwrapper"},[s("span",{staticStyle:{"font-size":"1.2rem"}},[e._v(e._s(e.getBirthday(e.birthdayVisiual)))])]),e._v(" "),e._m(1)])]),e._v(" "),s("div",{staticClass:"chooseaddress"},[s("mt-popup",{staticStyle:{"{width":"100%"},attrs:{position:"bottom"},model:{value:e.addressVisible,callback:function(t){e.addressVisible=t},expression:"addressVisible"}},[s("mt-picker",{ref:"addressPicker",attrs:{valueKey:"name",visibleItemCount:5,slots:e.addressSlots,position:"bottom"},on:{change:e.addressChange}})],1)],1),e._v(" "),s("div",{staticClass:"resetmint"},[s("mt-datetime-picker",{ref:"dataPicker",attrs:{type:"date",startDate:e.startDate,endDate:e.endDate,visiual:e.pickerVisible,"year-format":"{value} 年","month-format":"{value} 月"},on:{confirm:e.dateConfirm,change:e.dataChange},model:{value:e.relativeInfoForm.birthday,callback:function(t){e.$set(e.relativeInfoForm,"birthday",t)},expression:"relativeInfoForm.birthday"}})],1),e._v(" "),s("footer",[s("div",{staticClass:"confirm",on:{click:e.submitModify}},[e._v("提交")])]),e._v(" "),e.visiualMusk?s("div",{attrs:{id:"mask"},on:{click:e.disappearMusk}},[s("div",{attrs:{id:"changer"}},[e.visiualRel?s("div",{staticClass:"wrapper rel"},[s("div",{staticClass:"header"},[s("div",[e._v("取消")]),e._v(" "),s("div",{on:{click:function(t){return t.stopPropagation(),e.confirmModifyRel(t)}}},[e._v("确定")])]),e._v(" "),s("mt-picker",{attrs:{slots:e.slot},on:{change:e.onValuesChange}})],1):e._e()])]):e._e()])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"choose"},[t("span",{staticClass:"rel"},[this._v("请选择")]),this._v(" "),t("img",{attrs:{src:a("WkfF"),alt:""}})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"choose"},[t("span",{staticStyle:{"padding-right":"1rem"}},[this._v("请选择")]),this._v(" "),t("img",{attrs:{src:a("WkfF"),alt:""}})])}]};var l=a("VU/8")(o,n,!1,function(e){a("zvff")},"data-v-32155273",null);t.default=l.exports},zvff:function(e,t){}});