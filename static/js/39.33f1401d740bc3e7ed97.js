webpackJsonp([39],{kzTo:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("SoR+"),i=a.n(s),r=a("o6Vb"),o={name:"AddRelInfo",data:function(){return{temPath:"",pickerRel:"父子",currentAge:"",pickerAge:"",sexs:[{tag:"女"},{tag:"男"}],slot:[{flex:1,values:["父子","母子","父女","母女","近亲属"],className:"slot1",textAlign:"center"}],nameHodler:"亲属姓名",visiualMusk:!1,visiualRel:!1,visiualAge:!1,pickerVisible:!1,startDate:new Date("1930-01"),endDate:new Date,address:"",addressHodler:"（例：某小区A座6号楼6单元502室）",addressVisible:!1,regionInit:!1,addressSlots:[{flex:1,values:this.getProvinceArr(),className:"slot1",textAlign:"center"},{divider:!0,content:"",className:"slot2"},{flex:1,values:this.getCityArr("北京市"),className:"slot3",textAlign:"center"},{divider:!0,content:"",className:"slot4"},{flex:1,values:this.getCoutyArr("北京市","北京市"),className:"slot5",textAlign:"center"}],slots:[{flex:1,className:"slot1",textAlign:"center"}],relativeInfoForm:{relativesName:"",sex:0,nexus:"父子",birthday:new Date,addressDto:{province:"",city:"",district:"",street:"",streetNumber:""},age:""},birthdayVisiual:null,addressValue:"",addRelInfoSelected:"",timeControl:(new Date).getTime()}},beforeRouteEnter:function(e,t,a){a(function(e){e.temPath=t.path})},computed:{computedSexTag:function(){return this.sexs[this.relativeInfoForm.sex].tag},addRelInfoSelected_:function(){var e=this.$sessionStorage.getItem("addRelInfoSelectedPlain");this.$sessionStorage.getItem("addRelInfoSelected");return e}},watch:{},beforeRouteLeave:function(e,t,a){"User"!==e.name&&"HealthRecords"!==e.name||this.$sessionStorage.removeItem("editingRelInfo"),this.$sessionStorage.removeItem("addRelInfoSelected"),this.$sessionStorage.removeItem("addRelInfoSelectedPlain"),a()},mounted:function(){this.init()},methods:{init:function(){var e=this.$sessionStorage.getItem("editingRelInfo");if(e){this.relativeInfoForm=e;var t=new Date(e.birthday);this.birthdayVisiual=t.getFullYear()+"-"+(t.getMonth()+1)}var a=this.$sessionStorage.getItem("addRelInfoSelectedPlain"),s=this.$sessionStorage.getItem("addRelInfoSelected");a&&(this.addressPlainComputed=a),s&&(this.addRelInfoSelected=this.addressTransform(s),this.relativeInfoForm.addressDto=s,this.address=s.address)},addressTransform:function(e){return e.provinceName+"-"+e.cityName+"-"+e.areaName+"-"+e.streetName},routeBack:function(){this.$router.push({path:this.temPath}),this.$sessionStorage.removeItem("addRelInfoSelected"),this.$sessionStorage.removeItem("addRelInfoSelectedPlain")},submitModify:function(){var e=this;this.relativeInfoForm.age&&this.relativeInfoForm.relativesName?(new Date).getTime()-this.timeControl<3e3?alert("请不要重复提交"):(this.timeControl=(new Date).getTime(),this.relativeInfoForm.addressDto.address=this.address,Object(r.m)(this.relativeInfoForm).then(function(t){200===t.data.code&&(e.$message({message:t.data.msg,center:!0,type:"success",showClose:!0,duration:1e3}),e.$store.dispatch("SET_USER_INFO"),e.$router.push({path:"/healthrecords"}))})):alert("姓名-生日不能为空")},changeSex:function(e){this.relativeInfoForm.sex=e},clearname:function(){this.relativeInfoForm.relativesName=""},onValuesChange:function(e,t){this.pickerRel=t[0]},hodlerNameBlur:function(){this.nameHodler=""},hodlerNameFocus:function(){this.nameHodler=""},chooseRel:function(){this.visiualMusk=!0,this.visiualRel=!0,this.visiualAge=!1},chooseAge:function(){this.visiualRel=!1,this.visiualAge=!0,this.$refs.dataPicker.open()},disappearMusk:function(){this.visiualMusk=!1},confirmModifyRel:function(e){this.relativeInfoForm.nexus=this.pickerRel,this.visiualMusk=!1},handleConfirm:function(){},dataChange:function(e){},dateConfirm:function(e){e.setDate(2);var t=e.getFullYear(),a=e.getMonth()+1;this.relativeInfoForm.birthday=e,this.birthdayVisiual=t+"-"+a;var s=(new Date).getTime()-e.getTime();this.relativeInfoForm.age=this.getAccurAge(s)},getAccurAge:function(e){return(e/1e3/60/60/24/365).toFixed(2)},showAddressPicker:function(){this.addressVisible=!0},getProvinceArr:function(){var e=[];return i.a.forEach(function(t){var a={};a.name=t.name,a.code=t.code,e.push(a)}),e},getCityArr:function(e){var t=[];return i.a.forEach(function(a){a.name===e&&a.children.forEach(function(e){var a={};a.name=e.name,a.code=e.code,t.push(a)})}),t},getCoutyArr:function(e,t){var a=[];return i.a.forEach(function(s){s.name===e&&s.children.forEach(function(e){e.name===t&&e.children.forEach(function(e){var t={};t.name=e.name,t.code=e.code,a.push(t)})})}),a},addressChoose:function(){this.$router.push({path:"/choosereladdress"}),this.$sessionStorage.setItem("editingRelInfo",this.relativeInfoForm),this.$sessionStorage.removeItem("addRelInfoSelected"),this.$sessionStorage.removeItem("addRelInfoSelectedPlain")},addressChange:function(e,t){this.addressForm={countryCode:"CHN",countryName:"中国",provinceCode:t[0].code,provinceName:t[0].name,cityCode:t[1].code,cityName:t[1].name,areaCode:t[2]?t[2].code:"",areaName:t[2]?t[2].name:"",streetCode:"街道代码",streetName:""},this.relativeInfoForm.addressDto=this.addressForm,this.addRelInfoSelected=this.addressTransform(this.addressForm),e.setSlotValues(1,this.getCityArr(t[0].name)),e.setSlotValues(2,this.getCoutyArr(t[0].name,t[1].name))}}},n={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"addRelInfo"}},[s("header",[s("Backfront",{attrs:{maintitle:"新增亲属信息",isNormal:!0},on:{back:e.routeBack}})],1),e._v(" "),s("main",[s("div",{staticClass:"card",on:{click:e.chooseRel}},[s("p",{staticClass:"cardtitle"},[e._v("与您的关系:")]),e._v(" "),s("div",{staticClass:"inputwrapper"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.relativeInfoForm.nexus,expression:"relativeInfoForm.nexus"}],attrs:{type:"text",disabled:!0},domProps:{value:e.relativeInfoForm.nexus},on:{input:function(t){t.target.composing||e.$set(e.relativeInfoForm,"nexus",t.target.value)}}})]),e._v(" "),e._m(0)]),e._v(" "),s("div",{staticClass:"card"},[s("p",{staticClass:"cardtitle"},[e._v("姓名:")]),e._v(" "),s("div",{staticClass:"inputwrapper"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.relativeInfoForm.relativesName,expression:"relativeInfoForm.relativesName"}],attrs:{type:"text",placeholder:e.nameHodler},domProps:{value:e.relativeInfoForm.relativesName},on:{focus:e.hodlerNameFocus,blur:e.hodlerNameBlur,input:function(t){t.target.composing||e.$set(e.relativeInfoForm,"relativesName",t.target.value)}}})]),e._v(" "),s("div",{staticClass:"choose relativename"},[e.relativeInfoForm.relativesName?s("img",{attrs:{src:a("lz3y")},on:{click:e.clearname}}):e._e()])]),e._v(" "),s("div",{staticClass:"card"},[s("p",{staticClass:"cardtitle"},[e._v("性别:")]),e._v(" "),s("div",{staticClass:"inputwrapper"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.computedSexTag,expression:"computedSexTag"}],attrs:{type:"text",disabled:!0},domProps:{value:e.computedSexTag},on:{input:function(t){t.target.composing||(e.computedSexTag=t.target.value)}}})]),e._v(" "),s("div",{directives:[{name:"echo",rawName:"v-echo"}],staticClass:"choose sexs"},e._l(e.sexs,function(t,a){return s("div",{key:a,staticClass:"sex",on:{click:function(t){e.changeSex(a)}}},[s("span",{staticClass:"circle",class:{active:e.relativeInfoForm.sex===a}}),e._v(" "),s("span",[e._v(e._s(t.tag))])])}))]),e._v(" "),s("div",{staticClass:"card",on:{click:e.chooseAge}},[s("p",{staticClass:"cardtitle"},[e._v("生日:")]),e._v(" "),s("div",{staticClass:"inputwrapper"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.birthdayVisiual,expression:"birthdayVisiual"}],attrs:{type:"text",disabled:!0},domProps:{value:e.birthdayVisiual},on:{input:function(t){t.target.composing||(e.birthdayVisiual=t.target.value)}}})]),e._v(" "),e._m(1)])]),e._v(" "),s("div",{staticClass:"chooseaddress"},[s("mt-popup",{staticStyle:{"{width":"100%"},attrs:{position:"bottom"},model:{value:e.addressVisible,callback:function(t){e.addressVisible=t},expression:"addressVisible"}},[s("mt-picker",{ref:"addressPicker",attrs:{valueKey:"name",visibleItemCount:5,slots:e.addressSlots,position:"bottom"},on:{change:e.addressChange}})],1)],1),e._v(" "),s("div",{staticClass:"resetmint"},[s("mt-datetime-picker",{ref:"dataPicker",attrs:{type:"date",startDate:e.startDate,endDate:e.endDate,visiual:e.pickerVisible,"year-format":"{value} 年","month-format":"{value} 月"},on:{confirm:e.dateConfirm,change:e.dataChange},model:{value:e.relativeInfoForm.birthday,callback:function(t){e.$set(e.relativeInfoForm,"birthday",t)},expression:"relativeInfoForm.birthday"}})],1),e._v(" "),s("footer",[s("div",{staticClass:"confirm",on:{click:e.submitModify}},[e._v("提交")])]),e._v(" "),e.visiualMusk?s("div",{attrs:{id:"mask"},on:{click:e.disappearMusk}},[s("div",{attrs:{id:"changer"}},[e.visiualRel?s("div",{staticClass:"wrapper rel"},[s("div",{staticClass:"header"},[s("div",[e._v("取消")]),e._v(" "),s("div",{on:{click:function(t){return t.stopPropagation(),e.confirmModifyRel(t)}}},[e._v("确定")])]),e._v(" "),s("mt-picker",{attrs:{slots:e.slot},on:{change:e.onValuesChange}})],1):e._e()])]):e._e()])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"choose"},[t("span",{staticClass:"rel"},[this._v("请选择")]),this._v(" "),t("img",{attrs:{src:a("WkfF"),alt:""}})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"choose"},[t("span",{staticStyle:{"padding-right":"1rem"}},[this._v("请选择")]),this._v(" "),t("img",{attrs:{src:a("WkfF"),alt:""}})])}]};var l=a("VU/8")(o,n,!1,function(e){a("q7DY")},"data-v-7fc9e276",null);t.default=l.exports},q7DY:function(e,t){}});