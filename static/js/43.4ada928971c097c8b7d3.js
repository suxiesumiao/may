webpackJsonp([43],{"/GO+":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i("Dvzh"),r=i("o6Vb"),a=i("y1vT"),o={name:"ConsultConfirm",data:function(){return{value:"",visiualAlertCall:!1,temPath:"",nearby:!0,addressDetail:"",patientPhone:"",reservePhone:"",currentPatient:{},validateTable:{phone:{required:!0,reg:/^1\d{10}$/,message:"需要格式正确的手机号码"}}}},created:function(){this.$sessionStorage.getItem("dieaseDescribe")||this.$router.push({path:"/quickfinddoctor"})},mounted:function(){this.near(),this.getCurrentPatient()},computed:{sexNameComputed:function(){return this.currentPatient.sex?"男":"女"},ageComputed:function(){return(new Date).getFullYear()-new Date(this.currentPatient.birthday).getFullYear()},addressComputed:function(){var e=this.$sessionStorage.getItem("currentAddressOrder");return e?e.addressNormal+e.addressDetail:this.$store.getters.position+this.$store.getters.positionSub},coordsComputed:function(){var e=this.$sessionStorage.getItem("currentAddressOrder");return e?{lng:e.lng,lat:e.lat}:{lng:this.$store.getters.coords_transformed.longitude,lat:this.$store.getters.coords_transformed.latitude}},location:function(){},subAddress:function(){return this.$store.getters.position},dieaseDescribe:function(){var e=this.$sessionStorage.getItem("dieaseDescribe");return e}},watch:{$route:function(e,t){this.near()}},beforeRouteEnter:function(e,t,i){i(function(e){e.temPath=t.path})},beforeRouteLeave:function(e,t,i){"QuickFindDoctor"===e.name&&this.$sessionStorage.removeItem("currentPatient"),this.$sessionStorage.removeItem("lon_lat"),this.$sessionStorage.removeItem("chooseAddressOfPatient"),this.$sessionStorage.removeItem("chooseAddressOfPatientPlain"),i()},methods:{getTitle:function(e){return e.split("").map(function(e){return"<span>"+e+"</span>"}).join("")},getBirthday:function(e){if(!e)return"";var t=new Date(e),i=t.getFullYear(),s=t.getMonth()+1;return i+"-"+(s=s<10?"0"+s:s)},routeBack:function(){this.$router.push({path:"/quickfinddoctor",query:{doctorid:this.$route.query.doctorid}})},routeTo:function(){this.$router.push({path:"/waitforcure"})},near:function(){var e=this.$sessionStorage.getItem("userFrom");this.nearby=!e},modifyPatient:function(){this.$router.push({path:"/choosepatient",query:{doctorid:this.$route.query.doctorid}})},modifyAddress:function(){this.$router.push({path:"/medaddress",query:{doctorid:this.$route.query.doctorid,orderready:1}})},confirm:i.n(a)()(function(){var e=this;if(this.$route.query.doctorid&&this.$sessionStorage.getItem("currentDoctorInfo")){var t=this.coordsComputed,i={lat:this.$sessionStorage.getItem("currentDoctorInfo").lat,lon:this.$sessionStorage.getItem("currentDoctorInfo").lon},r=new BMap.Map("mapp").getDistance(new BMap.Point(t.lng,t.lat),new BMap.Point(i.lon,i.lat));if(console.log(r),r>1e4)return void alert("医生距您太远, 不能为您提供服务")}var a=this.validateTable.phone.reg;if(a.test(this.patientPhone)&&a.test(this.reservePhone)){var o={patientProjectCode:this.dieaseDescribe.patientProjectCode,patientDescription:this.dieaseDescribe.patientDescription,patientProjectName:this.dieaseDescribe.dieaseType,patientName:this.currentPatient.patientName,patientGender:this.currentPatient.sex,patientAge:this.ageComputed,patientBirthday:this.currentPatient.birthday+"-01",patientPhone:this.patientPhone,makePlatform:0,patientAddress:this.$store.state.positionModule.position_for_order,reservePhone:this.reservePhone,location:{lon:this.coordsComputed.lng,lat:this.coordsComputed.lat}},n=this.$sessionStorage.getItem("currentAddressOrder");n&&(o.patientAddress=n.address),this.$route.query.doctorid&&(o.doctorId=this.$route.query.doctorid),Object(s.f)(o).then(function(t){if(200===t.data.code){e.$sessionStorage.removeItem("dieaseDescribe"),e.$sessionStorage.removeItem("currentAddressOrder"),e.visiualAlertCall=!0;var i=e.$sessionStorage.getItem("currentDoctorInfo"),s={path:"/waitforcure",query:{orderid:t.data.data.toString(),lon:i?i.lon:void 0,lat:i?i.lat:void 0}},r=null;r=setTimeout(function(){clearTimeout(r),e.$router.push(s),e.visiualAlertCall=!1},1e3)}})}else alert(this.validateTable.phone.message)},500),visiualControlCall:function(){this.visiualAlertCall=!1},modifyDiease:function(){this.$router.push({path:"/quickfinddoctor"})},getCurrentPatient:function(){var e=this;Object(r.k)().then(function(t){if(200===t.data.code){if(!t.data.data.patientInfo.birthday||0===t.data.data.relativesList.length)return e.$message({message:"请完善个人以及亲属信息",type:"error"}),void e.$router.push({path:"/healthrecords"});e.$nextTick(function(){e.currentPatient=t.data.data.patientInfo,e.patientPhone=e.currentPatient.mobile,e.reservePhone=e.currentPatient.mobile;var i=e.$sessionStorage.getItem("currentPatient");i&&(e.currentPatient=i)})}})}}},n={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"consultconfirm"}},[s("header",[s("Backfront",{attrs:{maintitle:"咨询确认",isNormal:!0,customStyle:{backgroundColor:"transparent"},nextTitle:"下一步"},on:{back:e.routeBack,next:e.routeTo}},[s("span",{attrs:{slot:"operation"},slot:"operation"})])],1),e._v(" "),s("main",[e.nearby?s("p",{staticClass:"service"},[e._v("附近大约有 15 位医生为您提供专业的服务！")]):e._e(),e._v(" "),s("div",{staticClass:"cards"},[s("div",{staticClass:"card"},[s("div",{staticClass:"item",on:{click:e.modifyPatient}},[s("p",{domProps:{innerHTML:e._s(e.getTitle("患者姓名"))}}),e._v(" "),s("div",{staticClass:"inputwrapper"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.currentPatient.patientName,expression:"currentPatient.patientName"}],attrs:{type:"text",placeholder:"默认是自己",disabled:""},domProps:{value:e.currentPatient.patientName},on:{input:function(t){t.target.composing||e.$set(e.currentPatient,"patientName",t.target.value)}}}),e._v(" "),s("img",{attrs:{src:i("WkfF"),alt:""}})])]),e._v(" "),s("div",{staticClass:"item"},[s("p",{domProps:{innerHTML:e._s(e.getTitle("性别"))}}),e._v(" "),s("div",{staticClass:"inputwrapper"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.sexNameComputed,expression:"sexNameComputed"}],attrs:{type:"text",disabled:""},domProps:{value:e.sexNameComputed},on:{input:function(t){t.target.composing||(e.sexNameComputed=t.target.value)}}})])]),e._v(" "),s("div",{staticClass:"item"},[s("p",{domProps:{innerHTML:e._s(e.getTitle("出生日期"))}}),e._v(" "),s("div",{staticClass:"inputwrapper"},[s("span",{staticStyle:{"font-size":"1.2rem","padding-left":"1rem","margin-left":"1rem"}},[e._v(e._s(e.getBirthday(e.currentPatient.birthday)))])])])]),e._v(" "),e.dieaseDescribe?s("div",{staticClass:"card",on:{click:e.modifyDiease}},[s("div",{staticClass:"item"},[s("p",{domProps:{innerHTML:e._s(e.getTitle("疾病"))}}),e._v(" "),s("div",{staticClass:"inputwrapper"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.dieaseDescribe.dieaseType,expression:"dieaseDescribe.dieaseType"}],attrs:{type:"text",disabled:""},domProps:{value:e.dieaseDescribe.dieaseType},on:{input:function(t){t.target.composing||e.$set(e.dieaseDescribe,"dieaseType",t.target.value)}}})])]),e._v(" "),s("div",{staticClass:"item"},[s("p",{domProps:{innerHTML:e._s(e.getTitle("疾病描述"))}}),e._v(" "),s("div",{staticClass:"inputwrapper"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.dieaseDescribe.patientDescription,expression:"dieaseDescribe.patientDescription"}],attrs:{type:"text",disabled:""},domProps:{value:e.dieaseDescribe.patientDescription},on:{input:function(t){t.target.composing||e.$set(e.dieaseDescribe,"patientDescription",t.target.value)}}})])])]):e._e(),e._v(" "),s("div",{staticClass:"card"},[s("div",{staticClass:"item exception",on:{click:e.modifyAddress}},[s("p",{},[e._v("诊疗地址")]),e._v(" "),s("div",{staticClass:"addresswrapper",staticStyle:{"font-size":"1.2rem"}},[s("div",{staticClass:"container elli"},[e._v(e._s(e.addressComputed))])]),e._v(" "),s("img",{staticStyle:{height:"1.5rem"},attrs:{src:i("WkfF"),alt:""}})]),e._v(" "),s("div",{staticClass:"item exception"},[s("p",[e._v("信息发送至")]),e._v(" "),s("div",{staticClass:"inputwrapper"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.reservePhone,expression:"reservePhone"}],attrs:{type:"text"},domProps:{value:e.reservePhone},on:{input:function(t){t.target.composing||(e.reservePhone=t.target.value)}}})])]),e._v(" "),s("div",{staticClass:"item exception"},[s("p",[e._v("就诊人联系方式")]),e._v(" "),s("div",{staticClass:"inputwrapper"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.patientPhone,expression:"patientPhone"}],attrs:{type:"text"},domProps:{value:e.patientPhone},on:{input:function(t){t.target.composing||(e.patientPhone=t.target.value)}}})])])])]),e._v(" "),s("p",{staticClass:"rule"},[s("router-link",{attrs:{to:"/accountability"}},[e._v("问责规则以及责任提醒")])],1)]),e._v(" "),s("Doctoralert",{staticClass:"call",attrs:{visiualAlert:e.visiualAlertCall},on:{visiualControl:e.visiualControlCall}},[s("div",{staticClass:"head",attrs:{slot:"head"},slot:"head"},[s("div",{staticClass:"wrapper"},[s("img",{attrs:{src:i("eGXc"),alt:""}})])]),e._v(" "),s("div",{staticClass:"main",attrs:{slot:"main"},slot:"main"},[s("p",[e._v("您已预约成功")]),e._v(" "),s("p",[e._v("请等待医生接诊")])])]),e._v(" "),s("footer",[s("div",{staticClass:"confirm",on:{click:e.confirm}},[e._v("确定")])]),e._v(" "),s("div",{staticStyle:{overflow:"hidden",width:"0",height:"0"},attrs:{id:"mapp"}})],1)},staticRenderFns:[]};var d=i("VU/8")(o,n,!1,function(e){i("S+dw")},"data-v-6543118f",null);t.default=d.exports},"S+dw":function(e,t){}});