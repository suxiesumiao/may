webpackJsonp([48],{"/GO+":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("Dvzh"),r=i("o6Vb"),s=i("y1vT"),o={name:"ConsultConfirm",data:function(){return{value:"",visiualAlertCall:!1,temPath:"",nearby:!0,addressDetail:"",patientPhone:"",reservePhone:"",currentPatient:{},validateTable:{phone:{required:!0,reg:/^1\d{10}$/,message:"需要格式正确的手机号码"}}}},created:function(){this.$validate.init(this),this.$sessionStorage.getItem("dieaseDescribe")||this.$router.push({path:"/quickfinddoctor"})},mounted:function(){this.near(),this.getCurrentPatient()},computed:{sexNameComputed:function(){return this.currentPatient.sex?"男":"女"},ageComputed:function(){return(new Date).getFullYear()-new Date(this.currentPatient.birthday).getFullYear()},addressComputed:function(){var e=this.$sessionStorage.getItem("currentAddressOrder");return e?e.addressNormal+e.addressDetail:this.$store.getters.position+this.$store.getters.positionSub},coordsComputed:function(){var e=this.$sessionStorage.getItem("currentAddressOrder");return e?{lng:e.lng,lat:e.lat}:{lng:this.$store.state.positionModule.coords.longitude,lat:this.$store.state.positionModule.coords.latitude}},location:function(){var e=this.$sessionStorage.getItem("lon_lat");return e||{lon:this.$store.state.positionModule.coords.longitude,lat:this.$store.state.positionModule.coords.latitude}},subAddress:function(){return this.$store.getters.position},dieaseDescribe:function(){var e=this.$sessionStorage.getItem("dieaseDescribe");return e}},watch:{$route:function(e,t){this.near()}},beforeRouteEnter:function(e,t,i){i(function(e){e.temPath=t.path})},beforeRouteLeave:function(e,t,i){"QuickFindDoctor"===e.name&&this.$sessionStorage.removeItem("currentPatient"),this.$sessionStorage.removeItem("lon_lat"),this.$sessionStorage.removeItem("chooseAddressOfPatient"),this.$sessionStorage.removeItem("chooseAddressOfPatientPlain"),i()},methods:{getTitle:function(e){return e.split("").map(function(e){return"<span>"+e+"</span>"}).join("")},getBirthday:function(e){if(!e)return"";var t=new Date(e),i=t.getFullYear(),a=t.getMonth()+1;return i+"-"+(a=a<10?"0"+a:a)},routeBack:function(){this.$router.push({path:"/quickfinddoctor",query:{doctorid:this.$route.query.doctorid}})},routeTo:function(){this.$router.push({path:"/waitforcure"})},near:function(){var e=this.$sessionStorage.getItem("userFrom");this.nearby=!e},modifyPatient:function(){this.$router.push({path:"/choosepatient",query:{doctorid:this.$route.query.doctorid}})},modifyAddress:function(){this.$router.push({path:"/medaddress",query:{doctorid:this.$route.query.doctorid,orderready:1}})},confirm:i.n(s)()(function(){var e=this;this.$validate.check(this,"form_").then(function(t){var i={patientProjectCode:e.dieaseDescribe.patientProjectCode,patientDescription:e.dieaseDescribe.patientDescription,patientProjectName:e.dieaseDescribe.dieaseType,patientName:e.currentPatient.patientName,patientGender:e.currentPatient.sex,patientAge:e.ageComputed,patientBirthday:e.currentPatient.birthday+"-01",patientPhone:e.patientPhone,makePlatform:0,patientAddress:e.$store.state.positionModule.position_for_order,reservePhone:e.reservePhone,location:{lon:e.coordsComputed.lng,lat:e.coordsComputed.lat}},r=e.$sessionStorage.getItem("currentAddressOrder");r&&(i.patientAddress=r.address),e.$route.query.doctorid&&(i.doctorId=e.$route.query.doctorid),Object(a.f)(i).then(function(t){if(200===t.data.code){e.$sessionStorage.removeItem("dieaseDescribe"),e.$sessionStorage.removeItem("currentAddressOrder"),e.visiualAlertCall=!0;var i=e.$sessionStorage.getItem("currentDoctorInfo"),a={path:"/waitforcure",query:{orderid:t.data.data.toString(),lon:i?i.lon:void 0,lat:i?i.lat:void 0}},r=null;r=setTimeout(function(){clearTimeout(r),e.$router.push(a),e.visiualAlertCall=!1},1e3)}})}).catch(function(e){})},500),visiualControlCall:function(){this.visiualAlertCall=!1},modifyDiease:function(){this.$router.push({path:"/quickfinddoctor"})},getCurrentPatient:function(){var e=this;Object(r.k)().then(function(t){if(200===t.data.code){if(!t.data.data.patientInfo.birthday||0===t.data.data.relativesList.length)return e.$message({message:"请完善个人以及亲属信息",type:"error"}),void e.$router.push({path:"/healthrecords"});e.$nextTick(function(){e.currentPatient=t.data.data.patientInfo,e.patientPhone=e.currentPatient.mobile,e.reservePhone=e.currentPatient.mobile;var i=e.$sessionStorage.getItem("currentPatient");i&&(e.currentPatient=i)})}})}}},n={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"consultconfirm"}},[a("header",[a("Backfront",{attrs:{maintitle:"咨询确认",isNormal:!0,customStyle:{backgroundColor:"transparent"},nextTitle:"下一步"},on:{back:e.routeBack,next:e.routeTo}},[a("span",{attrs:{slot:"operation"},slot:"operation"})])],1),e._v(" "),a("main",[e.nearby?a("p",{staticClass:"service"},[e._v("附近大约有 15 位医生为您提供专业的服务！")]):e._e(),e._v(" "),a("div",{staticClass:"cards"},[a("div",{staticClass:"card"},[a("div",{staticClass:"item",on:{click:e.modifyPatient}},[a("p",{domProps:{innerHTML:e._s(e.getTitle("患者姓名"))}}),e._v(" "),a("div",{staticClass:"inputwrapper"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.currentPatient.patientName,expression:"currentPatient.patientName"}],attrs:{type:"text",placeholder:"默认是自己",disabled:""},domProps:{value:e.currentPatient.patientName},on:{input:function(t){t.target.composing||e.$set(e.currentPatient,"patientName",t.target.value)}}}),e._v(" "),a("img",{attrs:{src:i("WkfF"),alt:""}})])]),e._v(" "),a("div",{staticClass:"item"},[a("p",{domProps:{innerHTML:e._s(e.getTitle("性别"))}}),e._v(" "),a("div",{staticClass:"inputwrapper"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.sexNameComputed,expression:"sexNameComputed"}],attrs:{type:"text",disabled:""},domProps:{value:e.sexNameComputed},on:{input:function(t){t.target.composing||(e.sexNameComputed=t.target.value)}}})])]),e._v(" "),a("div",{staticClass:"item"},[a("p",{domProps:{innerHTML:e._s(e.getTitle("出生日期"))}}),e._v(" "),a("div",{staticClass:"inputwrapper"},[a("span",{staticStyle:{"font-size":"1.2rem","padding-left":"1rem","margin-left":"1rem"}},[e._v(e._s(e.getBirthday(e.currentPatient.birthday)))])])])]),e._v(" "),e.dieaseDescribe?a("div",{staticClass:"card",on:{click:e.modifyDiease}},[a("div",{staticClass:"item"},[a("p",{domProps:{innerHTML:e._s(e.getTitle("疾病"))}}),e._v(" "),a("div",{staticClass:"inputwrapper"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.dieaseDescribe.dieaseType,expression:"dieaseDescribe.dieaseType"}],attrs:{type:"text",disabled:""},domProps:{value:e.dieaseDescribe.dieaseType},on:{input:function(t){t.target.composing||e.$set(e.dieaseDescribe,"dieaseType",t.target.value)}}})])]),e._v(" "),a("div",{staticClass:"item"},[a("p",{domProps:{innerHTML:e._s(e.getTitle("疾病描述"))}}),e._v(" "),a("div",{staticClass:"inputwrapper"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.dieaseDescribe.patientDescription,expression:"dieaseDescribe.patientDescription"}],attrs:{type:"text",disabled:""},domProps:{value:e.dieaseDescribe.patientDescription},on:{input:function(t){t.target.composing||e.$set(e.dieaseDescribe,"patientDescription",t.target.value)}}})])])]):e._e(),e._v(" "),a("div",{staticClass:"card"},[a("div",{staticClass:"item exception",on:{click:e.modifyAddress}},[a("p",{},[e._v("诊疗地址")]),e._v(" "),a("div",{staticClass:"addresswrapper",staticStyle:{"font-size":"1.2rem"}},[a("div",{staticClass:"container elli"},[e._v(e._s(e.addressComputed))])]),e._v(" "),a("img",{staticStyle:{height:"1.5rem"},attrs:{src:i("WkfF"),alt:""}})]),e._v(" "),a("div",{staticClass:"item exception"},[a("p",[e._v("信息发送至")]),e._v(" "),a("div",{staticClass:"inputwrapper"},[a("input",{directives:[{name:"validate",rawName:"v-validate:form_$reserve",value:e.validateTable.phone,expression:"validateTable.phone",arg:"form_$reserve"},{name:"model",rawName:"v-model",value:e.reservePhone,expression:"reservePhone"}],attrs:{type:"text"},domProps:{value:e.reservePhone},on:{input:function(t){t.target.composing||(e.reservePhone=t.target.value)}}})])]),e._v(" "),a("div",{staticClass:"item exception"},[a("p",[e._v("就诊人联系方式")]),e._v(" "),a("div",{staticClass:"inputwrapper"},[a("input",{directives:[{name:"validate",rawName:"v-validate:form_$patient",value:e.validateTable.phone,expression:"validateTable.phone",arg:"form_$patient"},{name:"model",rawName:"v-model",value:e.patientPhone,expression:"patientPhone"}],attrs:{type:"text"},domProps:{value:e.patientPhone},on:{input:function(t){t.target.composing||(e.patientPhone=t.target.value)}}})])])])]),e._v(" "),a("p",{staticClass:"rule"},[a("router-link",{attrs:{to:"/accountability"}},[e._v("问责规则以及责任提醒")])],1)]),e._v(" "),a("Doctoralert",{staticClass:"call",attrs:{visiualAlert:e.visiualAlertCall},on:{visiualControl:e.visiualControlCall}},[a("div",{staticClass:"head",attrs:{slot:"head"},slot:"head"},[a("div",{staticClass:"wrapper"},[a("img",{attrs:{src:i("eGXc"),alt:""}})])]),e._v(" "),a("div",{staticClass:"main",attrs:{slot:"main"},slot:"main"},[a("p",[e._v("您已预约成功")]),e._v(" "),a("p",[e._v("请等待医生接诊")])])]),e._v(" "),a("footer",[a("div",{staticClass:"confirm",on:{click:e.confirm}},[e._v("确定")])])],1)},staticRenderFns:[]};var d=i("VU/8")(o,n,!1,function(e){i("RJhb")},"data-v-42adc1d4",null);t.default=d.exports},RJhb:function(e,t){}});